<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>tekuto.net</title>
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23511137-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-23511137-1');
        </script>
    </head>
    <body>
<!--過去ログ用
        <div>
            <p><a href="/">戻る</a></p>
        </div>
-->
<!-- ここから過去ログ時に削除 -->
        <h1>tekuto.net</h1>
        <div>
            <p>メール:g.tekuto@gmail.com</p>
            <p><a href="http://twitter.com/tekuto" target="_blank">twitter</a></p>
        </div>
<!--テンプレート
        <hr />
        <div>
            <h2>YYYY/MM/DD hh:mm</h2>
            内容
        </div>
-->
<!-- ここまで -->
        <hr />
        <div>
            <h2>2020/10/13 23:00</h2>
            <p>機能分割むずい。</p>
            <p>＊</p>
            <p>機能をMVCで分けるとして、ViewかControllerはActivityに書くかと考えていたが、どうも全部独立させた方がよさそうだな。</p>
            <p>Activityに書いてしまうと、他の要素に依存してしまってテストがうまく書けなくなる。</p>
            <p>ようやくたどり着いた結論としては、ModelとViewは完全に独立させてテストする。</p>
            <p>Controllerは同じインターフェースを持ったダミーのModelとViewを参照させてテストする。</p>
            <p>そこまではいいのだが、問題はViewのテストだ。</p>
            <p>どうもテスト用のActivityやレイアウトファイルを作らないとうまくいかない感じがある。</p>
            <p>テスト用の情報をAndroidManifest.xmlに書きたくないんだけど、これ別のファイルに分けられないのかな。</p>
            <p>検証が必要だ。</p>
        </div>
        <hr />
        <div>
            <h2>2020/09/01 01:30</h2>
            <p>全然書いてなかったな。</p>
            <p>＊</p>
            <p>サーバー側はさすがに完了してる。</p>
            <p>で、今クライアント側のandroidアプリ作ってる。</p>
            <p>javaとか、最新のは分からんけど、いや本当に知らないんだけど、使う気にならんのでkotlinとかいう言語で作ってる。</p>
            <p>javaをより実用的にしたような感じでいい感じ。</p>
            <p>大体の見た目は作ったのだけど、そこにUIパーツを組み合わせるのが少し難航していた。</p>
            <p>今日ようやくやり方が見えた。</p>
            <p>明日には手法を確立させて、見た目に機能を持たせて行きたい。</p>
        </div>
        <hr />
        <div>
            <h2>2020/07/30 03:00</h2>
            <p>ようやくサーバー側を完了できそう。</p>
            <p>＊</p>
            <p>最後の1つの機能追加が、ちょっと手を加える程度だと思っていたが予想外につまずいている。</p>
            <p>firestoreからデータを取る時に、複数のフィールドに不等号の条件付けるのが不可能とは知らなかった。</p>
            <p>幸い、対象のフィールドは同じ型の似たようなデータなので、統合したフィールドをもう1つ用意することで対応できそう。</p>
            <p>しかし、ちょっとした機能追加だと思っていたのにフィールドを追加するはめになるとは。</p>
            <p>追加するフィールドについて、色々テストが必要になるな。</p>
            <p>今週の頭には完了できるかと思っていたが、今週いっぱい使うことになりそうだ。</p>
            <p>＊</p>
            <p>これで、サーバー側のアルファ版が出来上がる。</p>
            <p>次にクライアント側のアルファ版を作り、身内でテスト。</p>
            <p>その次に様々な統計データを取れるようにしたベータ版を作り、無料で公開してテスト。</p>
            <p>最後にいくつか機能を追加した正式版を作り、有料で公開。</p>
            <p>こんな感じか？</p>
            <p>年内に正式版まで行きたいが、クライアント側の開発環境構築からして難航しそうな予感がしている。</p>
        </div>
        <hr />
        <div>
            <h2>2020/06/10 00:40</h2>
            <p>まだサーバー側も終わってない。</p>
            <p>＊</p>
            <p>ようやく当初予定していた基本機能の正常系は完了した感じか。</p>
            <p>あとは機能1つの異常系処理を追加すれば終わり。</p>
            <p>当初予定していたのはそれで終わりだけど、そこにもうちょい機能追加をする予定。</p>
            <p>＊</p>
            <p>モチベーションの低下がやばかった。</p>
            <p>DBの扱いでまごついたのが大きかったように思う。</p>
            <p>厳密にはDBではないのだが、トランザクションとかあるし似たようなもんだ。</p>
            <p>DBの扱いは経験が少なかったため、どう記述をまとめたらいいのか戸惑ってしまったのだ。</p>
        </div>
        <hr />
        <div>
            <h2>2020/04/23 03:15</h2>
            <p>サーバー側のマッチング処理はほぼできた。</p>
            <p>＊</p>
            <p>現状ではイレギュラー時のゴミが溜まってしまう状態なので、その除去が必要だがそのくらいだ。</p>
            <p>GoはC++と同じようにはいかない部分も多く、戸惑ってしまうことも少なくない。</p>
            <p>ここまで時間がかかったのは、暗号やレーティングなどの慣れない概念を扱ったこと以外に、その辺も関係してるんだろうな。</p>
            <p>＊</p>
            <p>今はゲームを構成するパーツを作っている。</p>
            <p>今週中には作り終えて、ゲーム本体の処理作成に入りたい。</p>
            <p>ゲーム本体部分には暗号化などのあまり複雑な概念は絡んでこないし、5月の頭ごろにはサーバー側の処理を作り終えられるだろうか。</p>
        </div>
        <hr />
        <div>
            <h2>2020/03/31 02:40</h2>
            <p>公開鍵暗号で作成済みのキーペアを利用する方法も確認。</p>
            <p>＊</p>
            <p>しかし、RSAはともかくECCはキーペアを読み込むだけでも妙に時間がかかる。</p>
            <p>RSAはおよそ100マイクロ秒、ECCはおよそ10ミリ秒、100倍程度の差がある。</p>
            <p>別の方式の暗号だから、それだけで単純に比較することはできないが。</p>
            <p>鍵長はそれぞれ、RSAの方は4096ビット、ECCは521ビット。</p>
            <p>ちょっと調べて出てきた情報によれば、RSAの鍵長4096ビットはECCの鍵長313ビットと同等、とあった。</p>
            <p>そこから考えても、今回ECCの方が時間かかっているというのは当然なのかも。</p>
            <p>というか、ECCの方はとりあえずでかいのを試してみただけなので、実際にはこんな長いのいらない気がする。</p>
            <p>どこかで見た情報では、ビットコインの電子署名は224ビットのECDSAを使っている、とかあった気がするし。</p>
            <p>＊</p>
            <p>さて、大体確認も済んだし、明日からまた進めて行こう。</p>
            <p>まずは自動テストの確認をするために作った対戦待ち受け開始処理に、暗号の対応を追加するところからかな。</p>
            <p>レーティングについてのデータ追加も必要だな。</p>
        </div>
        <hr />
        <div>
            <h2>2020/03/28 03:40</h2>
            <p>というわけでGoをやっている。</p>
            <p>＊</p>
            <p>必要になる技術は大抵触ったと思う。</p>
            <p>Goにおける自動テストに始まり、GAEで扱う予定なのでURLパラメータの受け取り方やJSON出力、firestore。</p>
            <p>共通鍵暗号、公開鍵暗号、電子署名、レーティング。</p>
            <p>大体こんなところだったか。</p>
            <p>これらを活用して、対戦型ゲームのバックエンドを作ろうと思う。</p>
            <p>androidアプリから接続して利用する感じ。</p>
            <p>＊</p>
            <p>暗号関係は、プログラム内で鍵を生成して利用する方法しか試していなかったな。</p>
            <p>すでに存在する鍵を利用する方法も確認しておかないと。</p>
        </div>
        <hr />
        <div>
            <h2>2020/03/20 04:40</h2>
            <p>バージョンは17日中に確定した。</p>
            <p>＊</p>
            <p>翌日には細かい修正をして、その次の日からは別件を進めようと調査したりなどしていた。</p>
            <p>今日は別件のサーバーサイドの処理について仕様を固めた。</p>
            <p>＊</p>
            <p>fgについては、セーブデータ機能もとりあえずできたわけだしコントローラ制御周りを進めたいところなんだが。</p>
            <p>大雑把なイメージしかないし、すぐはちょっと無理だなーという感じ。</p>
            <p>なので、少しの間別件を進めようかと。</p>
        </div>
        <hr />
        <div>
            <h2>2020/03/17 01:00</h2>
            <p>予定通り、セーブデータの削除機能追加完了。</p>
            <p>＊</p>
            <p>これでバージョンを確定するつもりだったけど、もうちょい変更を行う。</p>
            <p>型名の変更と、ファイル読み書き処理の例外処理を修正する。</p>
            <p>明日中にその2つを完了させて、バージョンを確定させたい。</p>
        </div>
        <hr />
        <div>
            <h2>2020/03/14 03:00</h2>
            <p>昨日、セーブデータのセーブ、ロード機能ができた。</p>
            <p>＊</p>
            <p>で、今日その機能が実際に機能するかどうか確認が取れた。</p>
            <p>前回の記事から察するに、1ヶ月以上かかってる。</p>
            <p>なんでこんなにかかってるんだろう。</p>
            <p>慣れない処理でテンション上がらなかった、というのは確かにあるんだけど。</p>
            <p>コミットログを見たら、fg::GameStateとかに変えたのをfg::GameContextに戻したり、などもやってたようだ。</p>
            <p>その踏ん切りがなかなかつかなかった、ってのもわずかに影響したか。</p>
            <p>それに、割と影響範囲が大きかったから仕方なかったのだろうか。</p>
            <p>＊</p>
            <p>大きな変更だったが、自動テストがあるおかげで無事に完了できた感じがある。</p>
            <p>自動テスト書いてなかったら、とても完了できていた気がしない。</p>
            <p>＊</p>
            <p>とはいえ、この機能はまだ不完全だ。</p>
            <p>セーブファイルの配置はこれでいいのだが、内容が不完全すぎる。</p>
            <p>内容の暗号化などをできるようにしたいが、どのように表現するかまだ考え中。</p>
            <p>＊</p>
            <p>そっちはともかく、セーブデータの削除機能はすぐ追加できそう。</p>
            <p>それを追加したらバージョンを確定しようと思う。</p>
        </div>
        <hr />
        <div>
            <h2>2020/02/08 04:00</h2>
            <p>セーブ機能の具体的な構成が大体決まった。</p>
            <p>＊</p>
            <p>前回大まかな構成を決めたと言ったが、構成と呼べるレベルでもなかったな。</p>
            <p>大まかにどのような処理を使うか、といった感じか。</p>
            <p>で、時間はかかったがどういう構成にするか決まった。</p>
            <p>来週、実際にヘッダファイルを作ってインターフェースを決めよう。</p>
            <p>＊</p>
            <p>セーブファイルを出力する機能というのは今までろくに考えたことなかったので、そのせいで余計に時間がかかってしまった。</p>
            <p>画面を出すセーブ機能はステートで、出さないセーブ機能はスレッドで処理することにした。</p>
            <p>それらが処理した結果は、スレッドで呼び出し元に通知する。</p>
            <p>＊</p>
            <p>前回の記述見たら、コマンドライン引数でディレクトリを指定する機能はまだ追加していなかったか。</p>
            <p>それは先週だったかに完了しておいた。</p>
        </div>
        <hr />
        <div>
            <h2>2020/01/24 02:00</h2>
            <p>セーブ機能について、大まかな構成を決めた。</p>
            <p>＊</p>
            <p>セーブとロード用のステートをベースシステムに用意する。</p>
            <p>それらのステートに遷移することで、専用の画面を作ることなくセーブとロードを行なえるようにする。</p>
            <p>あとは画面を出さないセーブとロードなんだが、こっちはまだ考え中。</p>
            <p>ゲーム用と考えるなら、fg::Stateにメンバ関数を追加して対応するべきかと思ったが、それだとfg::Stateが変に肥大化してしまうような。</p>
            <p>それに、ベースシステム用のものが用意できなくなる。</p>
            <p>そうなると、fg::GameStateとfg::BasesystemStateにそれぞれ用意するべきだろうか。</p>
            <p>それだって、大抵は別のステートが積み重なってて無効状態になっているはずであり、そこにアクセスして機能を動かす、というのはなんだか違和感がある。</p>
            <p>どうしたものかな。</p>
            <p>画面を出さないセーブとロードができなければ、先に進めないのだが。</p>
            <p>＊</p>
            <p>それより先に、コマンドライン引数でディレクトリの指定をできるようにしておくべきかな。</p>
            <p>今のところ、ホームディレクトリやシステムディレクトリはハードコーディングされている。</p>
            <p>テストのことを考えるなら、ここは変更できるようにしておくべきだろう。</p>
            <p>セーブファイルはホームディレクトリ内に配置される予定なので、その辺を進める上でも関係してくるし。</p>
        <hr />
        <div>
            <h2>2020/01/22 00:00</h2>
            <p>CoreManagerを排除した構成の動作確認まで完了。</p>
            <p>＊</p>
            <p>モチベーションのせいか、時間がかかりすぎだがどうにかなった。</p>
            <p>不要になった部分の削除がまだ済んでいないので、明日はそこから。</p>
            <p>＊</p>
            <p>その次はセーブ機能を用意するべきかな。</p>
            <p>元々、その辺の問題で仕様変更が必要だったわけだし。</p>
        </div>
<!--過去ログ用
        <hr />
        <div>
            <p><a href="/">戻る</a></p>
        </div>
-->
<!-- ここから過去ログ時に削除 -->
        <hr />
        <div>
            <h2>過去ログ</h2>
            <p><a href="2019.html">2019</a></p>
            <p><a href="2018.html">2018</a></p>
            <p><a href="2017.html">2017</a></p>
            <p><a href="2016.html">2016</a></p>
            <p><a href="2015.html">2015</a></p>
            <p><a href="2014.html">2014</a></p>
            <p><a href="2013.html">2013</a></p>
        </div>
<!-- ここまで -->
    </body>
</html>
