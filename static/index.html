<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>tekuto.net</title>
        <link rel="stylesheet" href="style.css" />
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-23511137-1']);
            _gaq.push(['_setDomainName', '.tekuto.net']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>
    <body>
<!--過去ログ用
        <div>
            <p><a href="/">戻る</a></p>
        </div>
-->
<!-- ここから過去ログ時に削除 -->
        <h1>tekuto.net</h1>
        <div>
            <p>メール:g.tekuto@gmail.com</p>
            <p><a href="http://twitter.com/tekuto" target="_blank">twitter</a></p>
        </div>
<!--テンプレート
        <hr />
        <div>
            <h2>YYYY/MM/DD hh:mm</h2>
            内容
        </div>
-->
<!-- ここまで -->
        <hr />
        <div>
            <h2>2014/10/29 19:35</h2>
            <p>まためんどくなってた。</p>
            <p>＊</p>
            <p>sucrose-windowを作成中。あとはイベントハンドラの対応のみ。</p>
            <p>色々考えて、また少しイベントハンドラの扱いを変えた。</p>
            <p>イベントハンドラ部分については、ウィンドウシステムの実装とは無関係だと思ったので、sucrose-window-commonというライブラリに分離させた。</p>
            <p>linux用の、xlibを使う実装はsucrose-window-xlibとして作成してある。</p>
            <p>で、イベントハンドラ部分をあまりめんどくなさそうな感じに設計を変えたので、明日ぐらいには作り終えられるのではと考えている。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/20 19:25</h2>
            <p>順調、と言いたいがやはりスローペースな気がする。</p>
            <p>＊</p>
            <p>とりあえず、sucrose-jsonは使えるようにした。</p>
            <p>あとはsucrose-mainを使えるようにすれば、dropmakerを動かせるが。</p>
            <p>しかし、シンボルの取得とかは処理を書き直さねばならないだろう。</p>
            <p>CからC++にした影響だ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/17 21:20</h2>
            <p>よくよく考えたら、イベントハンドラでつまづいただけだったなぁ。</p>
            <p>＊</p>
            <p>なので、dropmakerに関しては、ほとんどそのままソースを持ってくればいいか、という気分になっている。</p>
            <p>細かく修正を入れようとして時間食うよりずっといい。</p>
            <p>昨日加えた修正の件も考えて、持ってきたソースの中の不要になるconst_castを消していっているのだが、参照系のクラスは全部2種類用意するべきかもしれないなぁ。</p>
            <p>というのも、fg::JsonObjectPairsで似たような状態が発生しているのだ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/16 21:00</h2>
            <p>体調がびみょう。</p>
            <p>＊</p>
            <p>このところ、そのせいか分からんがびみょうに思考がまとまりにくいし、集中もできてないような。</p>
            <p>そんな感じで進みも悪い。</p>
            <p>＊</p>
            <p>文字列参照型を2種類にした。</p>
            <p>std::basic_stringみたいな位置付けのやつだが、std::basic_stringと違い、自身では文字列の領域を保持したりせず、他のところに配置されている文字列を参照する型なのだが。</p>
            <p>今までの構成だとコンストラクタがchar *なので、const char *を入れようとするとconst_castしなければならなくてめんどすぎる。</p>
            <p>なので、コンストラクタにconst char *をつっこむのと、char *をつっこむやつの2種類の型を作ることにした。</p>
            <p>後者の型を前者の型の子クラスにしたので、わざわざオーバーロードした関数を用意しなくても済むし。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/14 21:30</h2>
            <p>10日に書き忘れた。</p>
            <p>＊</p>
            <p>gitのログ見てみたらなんかおかしいな。何回sucrose-commonの生成ルールを追加してるんだ。</p>
            <p>直すのもめんどくさいが。</p>
            <p>＊</p>
            <p>とりあえず、sucrose-commonとsucrose-strconv-iconvを作った。</p>
            <p>前のプロジェクトではstrconvは一度に1種類しかビルドできなかったが、今のプロジェクトでは複数の実装を一緒にビルドできるようにしてあるため、名前を変えた。iconvを使っているので末尾にiconvと足してある。</p>
            <p>commonとstrconvを作ったので、コマンドライン引数を処理するだけのプログラムがビルドできるようになった。</p>
            <p>が、リンクする静的ライブラリ名をハードコーディングしているので、それはどうにかするべきだな。</p>
            <p>必要に応じてコマンドライン引数から指定できるようにしたいが、どうやって処理するべきか。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/09 21:11</h2>
            <p>前のプロジェクトからソースをどんどん持ってきている。</p>
            <p>＊</p>
            <p>2種類のライブラリを生成する件についてはどうにかなった。</p>
            <p>違うプロジェクト間で、wscriptを同一にしなければならないという決まりがあるでもなし、プロジェクト毎に不要なものは削除し、必要なものは追加して対応することにした。</p>
            <p>早いところ、今までに作った部分は移行してしまって、新機能を作成していきたいところ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/08 20:10</h2>
            <p>ビルドの簡略化はできた。</p>
            <p>＊</p>
            <p>とりあえず前のプロジェクトからソースファイルをそのまま持ってきて、fg-commonの生成がきちんとできるのは確認した。</p>
            <p>正確には、fgppからソースを持ってきたのでFGPPをFGに、fgppをfgに置換したりはしたが。</p>
            <p>あれ、よく考えたらあるライブラリについて、静的ライブラリと動的ライブラリの2種類作るのはできなくないか？</p>
            <p>どうしよう。ぱっと思い付く修正案はあるものの、それでいいのかどうか。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/07 22:55</h2>
            <p>早速、作り直し中。</p>
            <p>＊</p>
            <p>ビルドの簡略化を行なっているが、想定よりちょっとめんどかった。</p>
            <p>あるパッケージに存在するモジュールの一覧を取得する処理が、そう簡単にはいかなかった。</p>
            <p>dir()はロード済みのモジュールしか取得できないし。</p>
            <p>調べたら、ModuleScannerというのを使えばいいというのは分かったので、それを使ってコマンドラインオプションを作るところまではやった。</p>
            <p>次は、そのコマンドラインオプションを使用した際に、対象のモジュールのビルドを実行する処理を作る。</p>
            <p>うまくいけば、新たにモジュールのビルドルールを追加しても、他のところにその処理を呼び出す処理を追加しなくても済む。</p>
            <p>configure時にコマンドラインオプションを追加するだけで、そのビルドルールでモジュールが生成されるようになる。</p>
            <p>また、コマンドラインオプションで指定しなければ、モジュールをビルドしないようにもできる。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/06 22:56</h2>
            <p>って、いかん。何また難しくしようとしてるんだ。</p>
            <p>＊</p>
            <p>まずはC/C++だけ、もしくはC++だけ扱うのでもいいじゃないか。</p>
            <p>まだ一つも完成させてすらいないのに、最初から事を大きくしすぎだ。</p>
            <p>JavaとかPythonとかPerlとか、まだ必要な場面ではないのだ。</p>
            <p>＊</p>
            <p>また迷走して時間ばかりかけてしまうところだった。</p>
            <p>メインのライブラリはどうしよう。また作り直すべきだろうか。</p>
            <p>今度は本格的に処理は丸々使えるが、今のプロジェクトに修正を加える形でもいい気がする。</p>
            <p>しかし、この機会にビルドの仕組みの簡略化もしてしまいたいし。</p>
            <p>それをする場合、やはり作り直すべきな気がする。</p>
            <p>というか、インターフェースライブラリはそのままでいいな。</p>
            <p>いや、ビルドの仕組みの簡略化はインターフェースライブラリもやるけど、それは修正を加える形でいいだろう。</p>
            <p>この際だから、Cのラッパーライブラリも作らず、完全にC++だけの構成にしてしまってもいいかもしれない。</p>
            <p>ラッパーというか、他の言語に同じインターフェースがあると、一方に修正を加えたらそちらにも同じ加えたくなるし。</p>
            <p>コードの量は増えてもできることは増えてないという、効率の悪いことになるし。</p>
            <p>＊</p>
            <p>うむ。C++のインターフェースライブラリ「fg」、実装ライブラリ「sucrose」、ライブラリ利用環境「dropmaker」という3つのプロジェクトから成る構成にするかな。</p>
            <p>あと、ライブラリ利用デモ「fgdemos」の4つか。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/06 22:20</h2>
            <p>結局、C++のライブラリをメインにした方がいい気がしてきた。</p>
            <p>＊</p>
            <p>イベントハンドラの関係で、C言語のライブラリをメインにしているとラッパーライブラリがうまく作れないのだ。</p>
            <p>逆に、C++のライブラリをメインにして、C言語のそのラッパーライブラリにすればうまくいくんじゃないかなぁ、といったところ。</p>
            <p>そもそもC言語のライブラリをメインに持ってきたところで、それを直接使うわけでもないし。</p>
            <p>C言語を直接使ってゲーム作るのとかやりたくないし。</p>
            <p>しかし、その程度で大きく変更をかけるのは場当たりすぎる気がする。</p>
            <p>もうちょっとこう、他の言語との連携周りなのだから、その辺どのように対応するのかを考えてから処理したいところだが。</p>
            <p>現状ではどうあがいてもC/C++などで作られた、lib*.soとか*.dllとかのライブラリしか対応できないわけで。</p>
            <p>例えば.jarやら.pyやら.pl、.pmやらも使えるようにしてみたいところ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/03 21:52</h2>
            <p>ウィンドウ制御処理、大体はできたのだが。</p>
            <p>＊</p>
            <p>ウィンドウ内全てについて再描画処理をリクエストする処理についてはまだ。</p>
            <p>XGetGeometry()の処理が完了せず止まってしまうことがある。原因はまだ不明。</p>
            <p>おそらく、このへんも昔に通った道のはずなのだが。</p>
            <p>もしかしたら、xorg-serverのバージョンアップが影響しているかもしれないが、多分そんな大げさなことはないだろう。</p>
            <p>というか、この関数本当に必要だろうか。なんとなく必要な気がする、というだけで存在させている感は否めない。</p>
            <p>やりたいなら、ウィンドウサイズ変更イベントのイベントハンドラを設定しておいてウィンドウサイズを取得し、それを使ってウィンドウ内全てに再描画リクエストを投げてもいいのだ。</p>
            <p>ウィンドウの位置についても、どうもxlibではうまいこと制御できない感があるので、というか前にもこれは体験した気がするので、ウィンドウの位置は制御できないようにした。</p>
            <p>これと同じように、関数自体を消すという対応でいい気もする。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/02 23:25</h2>
            <p>イベント発生時のイベントハンドラ呼び出し処理を追加している。</p>
            <p>＊</p>
            <p>イベントハンドラの設定とかその辺については、ウィンドウ制御側からは触らんわけだし、イベント発生時の処理を書いた後でもいいかなって感じで。</p>
            <p>イベント発生時の処理はリセット前のプロジェクトとほぼ同じで大丈夫なので、さくっと片付けてしまいたいところ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/10/01 19:12</h2>
            <p>おかしいな、イベントハンドラの形式が古い。</p>
            <p>＊</p>
            <p>set形式は色々だめだと判断して、add/remove形式に変えたはずなのだけれど、その形式にしたソースが見つからない。</p>
            <p>そんなもんだから、今のAPIはset形式になってしまっている。</p>
            <p>直さないといかんなー</p>
            <p>＊</p>
            <p>ウィンドウ制御については、とりあえず表示と、イベント処理スレッドの起動までは作った。</p>
            <p>で、イベントハンドラの呼び出しとかが必要になってきた時点で、前述の問題に気が付いた感じ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/30 19:45</h2>
            <p>終了関数については、結局後回し。</p>
            <p>＊</p>
            <p>xlibを使ったウィンドウ制御について実装を始めている。</p>
            <p>リセット前のプロジェクトを参考にしているものの、前の物よりは分かりやすいものにしようと考えながら記述している。</p>
            <p>その中で、ラムダ関数への変数のムーブキャプチャを使ったのだが、なんかエラーが消えないと思ったら、どうやらconstでキャプチャされるらしい。</p>
            <p>参照キャプチャではそんなことはなかったようなのだが。ふしぎ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/29 20:40</h2>
            <p>ひとまず、初期化処理呼び出しの位置変更は完了した。</p>
            <p>＊</p>
            <p>しかし、終了処理についてはまだ考え中。</p>
            <p>初期化関数の引数に、関数ポインタの参照を渡してそれに終了関数のアドレスを設定するという方法はあまりよくない気がする。</p>
            <p>直感的でないというかなんというか、分かりにくいというか。</p>
            <p>そんな回りくどい方法を取るくらいなら、設定ファイルに初期化関数名と終了関数名のペアを書いておくとかの方がいい気がする。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/26 19:20</h2>
            <p>どうも暴走していたようだ。</p>
            <p>＊</p>
            <p>昨日書いたことはどうにも浅はかすぎる。終了処理の呼び出しは同じように書くべきではないと思った。</p>
            <p>初期化処理の呼び出しと同じように、終了関数を設定ファイルで指定することで、モジュールをアンロードする前に終了処理を呼び出す、というのは安直だが、安直すぎてだめだ。</p>
            <p>それだと、初期化処理が途中で失敗した場合、どの終了処理を呼び出すべきで、どの終了処理は呼び出すべきでないのか。</p>
            <p>こういうのはよく、終了処理は全て絶対に呼び出し、終了処理の中で、初期化してあるなら処理を行ない、初期化していないなら何もしない、と書くべきなどと言われるが、私はそういうのが嫌いなのだ。初期化してないなら終了処理は必要ないのだから、最初から呼び出さない方がすっきりする。</p>
            <p>例えば、初期化処理の引数として関数ポインタの参照を渡しておき、初期化処理が正常終了する場合に対応する終了関数のアドレスを設定する、などすればいい感じになりそう。</p>
            <p>＊</p>
            <p>しかしながら、現状では安直な方法ですら行なうのが困難な状況だ。</p>
            <p>モジュールのアンロード処理で、ロードしたモジュールを表現するvoid*しか情報をもらっていないため、どこかに終了処理の関数名を含めるとかいったことができないのだ。</p>
            <p>構成を間違えた感じがある。モジュールのロード、アンロード処理に、初期化、終了の処理を含めるべきではなかったのだ。</p>
            <p>単純に巻き戻してしまってもいい気がする。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/25 21:00</h2>
            <p>初期化処理できあがり。</p>
            <p>＊</p>
            <p>次は、初期化処理と共通の部分は共通化して終了処理の呼び出しを作成する。</p>
            <p>厳密には、現時点ではまだ必要ないと思われるが、ほぼ同じ処理なわけだし、ちょっとしたらすぐ必要になると思うし。</p>
            <p>作っておいて損ないだろう、といったところ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/24 23:36</h2>
            <p>初期化処理の追加、途中までできた。</p>
            <p>＊</p>
            <p>初期化処理を走らせるところはできたので、次は走らせる処理を指定するところ。</p>
            <p>それが出来たら、終了処理についても同じように追加する。</p>
            <p>しかし、ModuleInfoとModuleKeyを分けている意味がないような気がする。</p>
            <p>一緒にしちゃってもいいんじゃないかな。</p>
            <p>＊</p>
            <p>ビルドの仕組み、簡略化すべきかも。</p>
            <p>現状では、あるモジュールについて、configureする時に実装を指定することで、その実装を使ったモジュールをビルドするのだが、モジュールの名前を別にすることで、複数の実装を同時に存在できるようにしようかと。</p>
            <p>現状では、例えばウィンドウ管理のモジュールは、linux用のxlibを使った実装でも、windows用のwin32を使った実装でも、作られるモジュールの名前はlinuxならlibfg-window.so、windowsならfg-window.dllになる。</p>
            <p>でも、例えばxlibを使った実装ならfg-window-xlibとか、win32を使った実装ならfg-window-win32とかにすれば、実装が異なる複数のウィンドウ管理モジュールを共存させることができる。</p>
            <p>その環境はビルドできない実装の場合は、configureでビルドしないように指定すればいいのだし。</p>
            <p>この変更をすることで、多分ビルドの仕組みは今より簡単になるはずなのだ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/19 20:02</h2>
            <p>困った。</p>
            <p>＊</p>
            <p>初期化が必要なモジュールについての考慮が足りていなかった。</p>
            <p>今まで通り、各OSに用意されている機能を使ってもいい気がするが、あれはあまりよくない。</p>
            <p>初期化時に処理が失敗した場合にどうするとか、そういったことができない。多分。</p>
            <p>きちんと調べたわけではないのだが、少なくともwindowsでは関数が1つ固定、関数名すら固定だし、それを使うくらいならば自分で機能を作ってしまった方がいい気がする。</p>
            <p>今のところの考えでは、パッケージ設定に記述するモジュールの設定に、初期化関数を指定できる形にしようかと考えているがどうなんだろう。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/18 20:47</h2>
            <p>総ソースファイル行数が1000行ほど減った。</p>
            <p>＊</p>
            <p>今まで、共通化できそうだけどめんどうなので放置していた場所を、マクロで共通化した結果、そんな感じになった。</p>
            <p>これで、あとは実装部分をリセット前のプロジェクトから持ってくればウィンドウを扱えるようになるだろう。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/17 20:50</h2>
            <p>というわけで、ウィンドウの対応を始めた。</p>
            <p>＊</p>
            <p>リセットする前のプロジェクトからファイルを持ってきて、ちょっと修正を加えて使えるようにしたりなど。</p>
            <p>若干インターフェースやマクロの仕様が違うので、完全にそのまま使うわけにはいかない。</p>
            <p>一気にファイル数が増え、総ソースファイル数が300に迫る勢い。</p>
            <p>明日には300を越すだろう。</p>
            <p>しかし、メインウィンドウの生成はどこでやるべきか。</p>
            <p>コンテキストに参照を持たせることは決まっているが、コンテキスト生成処理に混ぜるか、生成後に参照をコンテキスト生成処理に渡すか。</p>
            <p>前者でいい気がするのだが、なんかしっくりこないような。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/16 19:08</h2>
            <p>とりあえず、コマンドライン引数対応は終えたのだが。</p>
            <p>＊</p>
            <p>この次、本当にパスの扱いについてやるべきだろうか。後回しでもいい気がしてきた。</p>
            <p>いい案がぱっと浮かばないし、なによりやる気があまりしないのだ。</p>
            <p>それよりも、リセットする前のプロジェクトには実装されていたウィンドウや入力機器、音声機器の管理機能をサクサクッと実装して、試しにゲームでも作ってみるべきな気がする。</p>
            <p>ゲームを作らんと、いつまで経っても話が進まんのだ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/12 20:23</h2>
            <p>どうにも作業速度が思うように上がらないと思ったら案の定だった。</p>
            <p>＊</p>
            <p>そんなわけでまだ出来上がっていないが今日は疲れた。</p>
            <p>このまま出来上がるまで続行するというのは昔はよくやっていた気もするが、これをするとその後一層気分がよくなくなるのだ。</p>
            <p>よくない連鎖は発生する前に止めるに限る。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/11 20:00</h2>
            <p>とりあえずコマンドライン引数対応を始めた。</p>
            <p>＊</p>
            <p>一応、リセットする前のプロジェクトでは実装されていた機能なので、大体はそこから持ってくればいいだけなのだが。</p>
            <p>その後の処理は完全に1から書くことになるわけで、出来上がるのは早くて明日だろうな。</p>
            <p>今日はこれ以上続けるとだらだらしちゃうからやめやめ。</p>
            <p>TODOコメントをいくつか、ヒントとして追加しておしまい。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/10 22:10</h2>
            <p>パスの扱いについてまだ考え中。</p>
            <p>＊</p>
            <p>今日はバグの修正やら細かい変更などをしていた。</p>
            <p>パスについては後回しにして、先にコマンドライン引数で起動するプログラムの指定をできるようにしてしまった方がいいかもしれない。</p>
            <p>実際に必要になる場面を先に作ってしまえばイメージしやすそうな気がする。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/09 19:40</h2>
            <p>静的リンクしていたライブラリを、モジュールとして動的リンクして扱うように修正した。</p>
            <p>＊</p>
            <p>当初の予定では、静的リンクしているライブラリ5つを全て動的リンクさせたかったのだが、よく考えたらそのうち4つはモジュール管理処理から使っているので分離できず、結局1つのライブラリしか取り外すことができなかった。</p>
            <p>しかしながら、そのおかげで奇妙な処理の仕方をしていた箇所を削除することができたし、成果は悪くない。イメージのサイズも小さくなったようだし。</p>
            <p>複数のライブラリを修正する予定だったのでマクロとかも作って修正しやすくしたのだが、結局1つのライブラリしか修正できなかったので、ちょっと大げさになってしまった感はある。</p>
            <p>とはいえ、今後別のライブラリをリンクさせる予定があるので、その時には役立つかも。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/08 19:26</h2>
            <p>プログラム起動前のモジュール読み込みについても、依存関係を解決した上で読み込むようにした。</p>
            <p>＊</p>
            <p>これにより、プログラム起動前に読み込むモジュールについても、別のモジュールに依存させることが可能になった。</p>
            <p>今までは対象のモジュールのみ読み込む形だったので、他のモジュールに依存させていると正しく動作しなかったが、それが解決された。</p>
            <p>現状では、プログラム起動前に読み込むモジュールは他のモジュールに依存できないのを前提とした書き方をしていたはずなので、その辺は修正していくべきだろうな。</p>
            <p>＊</p>
            <p>次はコマンドライン引数で起動するプログラムの指定をできるようにしたいところだが、これをするとなるとパスの扱いをきちんと考えんと。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/06 13:18</h2>
            <p>おとといバージョン上げて、昨日プログラム起動前に読み込むモジュールのどうのこうのの前準備をした。</p>
            <p>＊</p>
            <p>というのを昨日書けばよかったのに忘れていた。</p>
            <p>今日明日はあまり作業しないようにする。</p>
            <p>のんべんだらりとなってくると、余計にやる気が減退してしまってよくない。</p>
            <p>そんな感じで、土日やら祝日やら、あとは平日の夜とかも、意図的に作業しないようにしている。</p>
            <p>せいぜい、なんか思い付いたらメモしておく程度。</p>
            <p>その方が、作業中集中できるし気分的にもいい気がするのだ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/04 17:16</h2>
            <p>やることは色々思い付くが、ここらでバージョンを上げて区切っておくべきだろうか。</p>
            <p>＊</p>
            <p>依存解決ありのモジュールロード処理のプロトタイプは出来上がっているわけだし。</p>
            <p>今後、コマンドライン引数で起動するプログラムを指定したりとか、プログラム起動前に読み込むモジュールも依存解決ありの形にしたりだとか、その他諸々を予定している。</p>
            <p>後者の機能を実装するために、ファイルの配置を変えたりしていたが、そろそろバージョンを上げてネット上のリポジトリにpushしておくべきだろうな。</p>
            <p>調子が良さそうに思える時ほど、冷静にならねば無意識のうちに暴走、迷走して失敗するのだ。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/03 19:59</h2>
            <p>あるモジュールが複数モジュールから依存されている場合に、無駄にメモリ食ったり無駄な処理したりしないように修正した。</p>
            <p>＊</p>
            <p>簡単なデモプログラムを作ってみて、問題なく動作するのを確認した。</p>
            <p>しかし、必要なモジュールを依存モジュールリストから外しておいて、動作に失敗するはずのプログラムが普通に動いた、というのが起きた時はびびった。</p>
            <p>原因を調べたら、プログラムを実行するコアプログラム側に、必要なモジュールの処理が含まれており、プログラムがコアプログラム側の処理を呼び出しているために、普通に動いているように見える、ということだった。</p>
            <p>しかしコアプログラムはシンボルを全くエクスポートしていないはずなのに、なぜプログラム側から呼び出せているのか謎だったが、コアプログラムのリンク時に-rdynamicオプションを指定しているのがまずかったらしい。</p>
            <p>このオプションを付けているとバックトレースの表示を詳しくできるため、デバックビルドのリンク時には付けていた。</p>
            <p>しかしこのオプションの機能は「生成したファイル内に動的リンク用のシンボルを残す」というものであるため、今回のような問題が発生してしまったようだ。</p>
            <p>で、バックトレースを見る機会とか今のところほぼないし、別にいいかということで問題のオプションを使わないことで対応した。</p>
            <p>そもそもgrep backtraceとかやっても1件もヒットしなかったし、この記述自体が以前に作っていたプログラムの名残だったと思われる。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/02 18:44</h2>
            <p>やたー動いたー。</p>
            <p>＊</p>
            <p>もうちょい処理を追加する必要があるが、とりあえず動作するのを確認できた。</p>
            <p>依存モジュールのロードを行ない、プログラムを起動させることに成功。</p>
            <p>依存モジュールの指定方法をもうちょい種類増やしたりだとか、そもそも今のインターフェースで他の言語のプログラムを扱えるのかなど問題は色々あるものの、とりあえず一段落した気がする。</p>
            <p>あるモジュールが複数のモジュールから依存されている場合の処理をまだ書いてないので、それは追加する必要がある。</p>
            <p>それにしたって、効率的な処理にならない、というだけであり、想定では問題なく動作するはずだが。</p>
            <p>その辺確認するためにも、デモプログラムをいくつか作ってみる必要がありそう。</p>
            <p>モジュールの依存関係が循環してしまっている場合、現時点では正しく動作しない。多分無限ループみたくなって、そのうちスタック食い潰して落ちる。</p>
            <p>そもそも循環した依存関係というのが、他の言語とかでも常に許容されるのか分からんし、動作するように対応するかどうかはびみょう。循環を検出して、起動失敗にしたりなど、なんらかの対策は必要だろうけど。</p>
        </div>
        <hr />
        <div>
            <h2>2014/09/01 15:36</h2>
            <p>もうめんどいから過去ログに分割しなくてもいいんじゃないかな。</p>
            <p>＊</p>
            <p>パッケージシステムの暫定的な根幹ができあがりそうな感じ。</p>
            <p>＊</p>
            <p>また今日も、私の頭の中から湧き出た何かを形にするべく、その正体不明の何かを解析する作業。</p>
            <p>妄想なんだろうけど、見てはいけない何かを見つめ続けてしまっている気がする。</p>
            <p>そのうちもっと頭おかしくなるのではないだろうか。</p>
            <p>＊</p>
            <p>ポケモンエメラルドで捕まえられるポケモン全部捕まえた。</p>
            <p>あとはルビーやらサファイアやらでしか出現しないポケモンを捕まえて送り込まねば、ホウエン図鑑を埋めることはできない。</p>
            <p>送り込むだけならそれぞれのカートリッジと、安価で購入したゲームキューブとポケモンボックスを持っているのでできるのだが、通信ケーブルがないため通信進化ができない。</p>
            <p>アドバンスのケーブル、通販だと中古でも新品並みの値段になってたりするから困る。新品が定価の2、3倍とか頭おかしいと思う。手を出しがたい。</p>
            <p>＊</p>
            <p>さて、こわいこわい言ってないで作業せんと。クトゥルフ神話じゃないんだから未知に対する恐怖なんてあるものか。</p>
        </div>
<!--過去ログ用
        <hr />
        <div>
            <p><a href="/">戻る</a></p>
        </div>
-->
<!-- ここから過去ログ時に削除 -->
        <hr />
        <div>
            <h2>過去ログ</h2>
            <p><a href="201405.html">201405</a></p>
            <p><a href="201404.html">201404</a></p>
            <p><a href="201402.html">201402</a></p>
            <p><a href="201401.html">201401</a></p>
            <p><a href="201312.html">201312</a></p>
            <p><a href="201311.html">201311</a></p>
            <p><a href="201310.html">201310</a></p>
            <p><a href="201309.html">201309</a></p>
            <p><a href="201308.html">201308</a></p>
            <p><a href="201307.html">201307</a></p>
            <p><a href="201306.html">201306</a></p>
        </div>
<!-- ここまで -->
        <div id="for-nostylesheet">
            <hr />
            <img src="images/uni.png" />
        </div>
    </body>
</html>
